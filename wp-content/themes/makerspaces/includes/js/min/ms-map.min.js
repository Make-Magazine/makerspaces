"use strict";jQuery(document).ready(function(){Vue.use(VueTables.ClientTable),Vue.use(VueTables.Event);new Vue({el:"#directory",data:{columns:["mmap_eventname","physLoc","mmap_country","mmap_city","mmap_state"],tableData:[],options:{headings:{mmap_eventname:"Name",physLoc:"Location",mmap_country:"Country"},templates:{physLoc:function(e,a,t){var o=a.mmap_city;return a.mmap_state&&(o+=", "+a.mmap_state),o}},columnsDisplay:{mmap_country:"desktop"},columnsClasses:{mmap_eventname:"col-name",physLoc:"col-location",mmap_country:"col-country"},pagination:{chunk:5}},filterVal:"",map:null,mapDefaultZoom:2,mapDefaultPos:{lat:29.1070772,lng:-24.2299966},markers:""},created:function(){var a=this;axios.get("/wp-json/makemap/v1/mapdata/5").then(function(e){a.$refs.loadingIndicator.classList.add("hidden"),a.tableData=e.data.Locations,a.$refs.directoryGrid.setOrder("mmap_eventname",!0),a.detectBrowser(),a.getLocation(),a.initMap()}).catch(function(e){console.log(e),a.$refs.loadingIndicator.classList.add("hidden"),a.$refs.errorIndicator.classList.remove("hidden")})},methods:{detectBrowser:function(){var e=navigator.userAgent,a=this.$refs.map;-1!=e.indexOf("iPhone")||-1!=e.indexOf("Android")?(a.style.width="100%",a.style.height="300px"):(a.style.width="100%",a.style.height="400px")},initMap:function(){this.$refs.mapTableWrapper.classList.remove("map-table-hidden");var e=this.$refs.map,a={center:this.mapDefaultPos,zoom:this.mapDefaultZoom};this.map=new google.maps.Map(e,a),this.addMarkers()},getLocation:function(){var e=new google.maps.InfoWindow,t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var a={lat:e.coords.latitude,lng:e.coords.longitude};t.map.setCenter(a),t.map.setZoom(8)},function(){t.handleLocationError(!0,e,t.map.getCenter())}):t.handleLocationError(!1,e,t.map.getCenter())},handleLocationError:function(e,a,t){console.error("User location check failed")},doFilter:function(e){this.$refs.directoryGrid.setFilter(this.filterVal),this.addMarkers()},filterOverride:function(e){e.preventDefault()},onRowClick:function(e){var a={lat:parseFloat(e.row.mmap_lat),lng:parseFloat(e.row.mmap_lng)};this.map.panTo(a),this.map.setZoom(16)},addMarkers:function(){this.markers=this.tableData.map(function(e,a){var t={lat:parseFloat(e.mmap_lat),lng:parseFloat(e.mmap_lng)},o=new google.maps.Marker({position:t,label:""});return o.addListener("click",function(){new google.maps.InfoWindow({content:'<div style=""><h4>'+e.mmap_eventname+'</h4><p><a href="'+e.mmap_url+'" target="_blank">'+e.mmap_url+"</a></p></div>"}).open(this.map,o)}),o});new MarkerClusterer(this.map,this.markers,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}}})});
//# sourceMappingURL=ms-map.min.js.map